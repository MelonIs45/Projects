 using System;

namespace BF2CS
{
    class Program
    {
        static void Main(string[] args)
        {
            // 99 bottles of beer unit test
            string bf = @">++++++++++[<++++++++++>-]<->>>>>+++[>+++>+++<<-]<<<<+<[>[>+
                        >+<<-]>>[-<<+>>]++++>+<[-<->]<[[-]>>-<<]>>[[-]<<+>>]<<[[-]>>
                        >>>>[[-]<++++++++++<->>]<-[>+>+<<-]>[<+>-]+>[[-]<->]<<<<<<<<
                        <->>]<[>+>+<<-]>>[-<<+>>]+>+<[-<->]<[[-]>>-<<]>>[[-]<<+>>]<<
                        <[>>+>+<<<-]>>>[-<<<+>>>]++>+<[-<->]<[[-]>>-<<]>>[[-]<<+>>]<
                        <[>+<[-]]<[>>+<<[-]]>>[<<+>>[-]]<<<[>>+>+<<<-]>>>[-<<<+>>>]+
                        +++>+<[-<->]<[[-]>>-<<]>>[[-]<<+>>]<<[>+<[-]]<[>>+<<[-]]>>[<
                        <+>>[-]]<<[[-]>>>++++++++[>>++++++<<-]>[<++++++++[>++++++<-]
                        >.<++++++++[>------<-]>[<<+>>-]]>.<<++++++++[>>------<<-]<[-
                        >>+<<]<++++++++[<++++>-]<.>+++++++[>+++++++++<-]>+++.<+++++[
                        >+++++++++<-]>.+++++..--------.-------.++++++++++++++>>[>>>+
                        >+<<<<-]>>>>[-<<<<+>>>>]>+<[-<->]<[[-]>>-<<]>>[[-]<<+>>]<<<<
                        [>>>+>+<<<<-]>>>>[-<<<<+>>>>]+>+<[-<->]<[[-]>>-<<]>>[[-]<<+>
                        >]<<<[>>+<<[-]]>[>+<[-]]++>>+<[-<->]<[[-]>>-<<]>>[[-]<<+>>]<
                        +<[[-]>-<]>[<<<<<<<.>>>>>>>[-]]<<<<<<<<<.>>----.---------.<<
                        .>>----.+++..+++++++++++++.[-]<<[-]]<[>+>+<<-]>>[-<<+>>]+>+<
                        [-<->]<[[-]>>-<<]>>[[-]<<+>>]<<<[>>+>+<<<-]>>>[-<<<+>>>]++++
                        >+<[-<->]<[[-]>>-<<]>>[[-]<<+>>]<<[>+<[-]]<[>>+<<[-]]>>[<<+>
                        >[-]]<<[[-]>++++++++[<++++>-]<.>++++++++++[>+++++++++++<-]>+
                        .-.<<.>>++++++.------------.---.<<.>++++++[>+++<-]>.<++++++[
                        >----<-]>++.+++++++++++..[-]<<[-]++++++++++.[-]]<[>+>+<<-]>>
                        [-<<+>>]+++>+<[-<->]<[[-]>>-<<]>>[[-]<<+>>]<<[[-]++++++++++.
                        >+++++++++[>+++++++++<-]>+++.+++++++++++++.++++++++++.------
                        .<++++++++[>>++++<<-]>>.<++++++++++.-.---------.>.<-.+++++++
                        ++++.++++++++.---------.>.<-------------.+++++++++++++.-----
                        -----.>.<++++++++++++.---------------.<+++[>++++++<-]>..>.<-
                        ---------.+++++++++++.>.<<+++[>------<-]>-.+++++++++++++++++
                        .---.++++++.-------.----------.[-]>[-]<<<.[-]]<[>+>+<<-]>>[-
                        <<+>>]++++>+<[-<->]<[[-]>>-<<]>>[[-]<<+>>]<<[[-]++++++++++.[
                        -]<[-]>]<+<]";

            byte[] tape = new byte[10000];
            char[] data = bf.ToCharArray();
            int ptr = 0;
            int bracketCount = 0;

            translate(ref tape, ref data, ref ptr, ref bracketCount);

        }

        static void translate(ref byte[] tape, ref char[] data, ref int ptr, ref int bracketCount)
        {
            for (int i = 0; i < data.Length; i++)
            {
                switch (data[i])
                {
                    case '>':
                        ptr++;
                        break;
                    case '<':
                        ptr--;
                        break;
                    case '+':
                        tape[ptr]++;
                        break;
                    case '-':
                        tape[ptr]--;
                        break;
                    case '.':
                        Console.Write((char)tape[ptr]);
                        break;
                    case ',':
                        tape[ptr] = (byte)Console.ReadKey().KeyChar;
                        break;
                    case '[':
                        if (tape[ptr] == 0)
                        {
                            bracketCount++;
                            while (data[i] != ']' || bracketCount != 0)
                            {
                                i++;
                                if (data[i] == '[')
                                    bracketCount++;
                                else if (data[i] == ']')
                                    bracketCount--;
                            }
                        }
                        break;
                    case ']':
                        if (tape[ptr] != 0)
                        {
                            bracketCount++;
                            while (data[i] != '[' || bracketCount != 0)
                            {
                                i--;
                                if (data[i] == ']')
                                    bracketCount++;
                                else if (data[i] == '[')
                                    bracketCount--;
                            }
                        }
                        break;
                }
            }
        }
    }
}
